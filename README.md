# Ассемблер и интерпретатор для УВМ (Вариант №15)

## Описание

Проект реализует ассемблер и интерпретатор для учебной виртуальной машины (УВМ) согласно спецификации варианта №15.

## Язык ассемблера

### Мнемоники команд

#### 1. LOAD_CONST - Загрузка константы
Синтаксис: `LOAD_CONST <константа> <адрес>`

- Код операции: 111
- Размер: 6 байт
- Параметры:
  - `константа` (11 бит, 0-2047): значение для загрузки
  - `адрес` (26 бит, 0-67108863): адрес в памяти для сохранения

Пример:
```
LOAD_CONST 37 80
```

#### 2. READ_MEM - Чтение значения из памяти
Синтаксис: `READ_MEM <смещение> <адрес_источника> <адрес_назначения>`

- Код операции: 40
- Размер: 9 байт
- Параметры:
  - `смещение` (8 бит, 0-255): смещение относительно базового адреса
  - `адрес_источника` (26 бит, 0-67108863): базовый адрес для чтения
  - `адрес_назначения` (26 бит, 0-67108863): адрес для записи результата

Пример:
```
READ_MEM 82 877 682
```

#### 3. WRITE_MEM - Запись значения в память
Синтаксис: `WRITE_MEM <адрес_источника> <адрес_назначения>`

- Код операции: 101
- Размер: 8 байт
- Параметры:
  - `адрес_источника` (26 бит, 0-67108863): адрес источника данных
  - `адрес_назначения` (26 бит, 0-67108863): адрес для записи

Пример:
```
WRITE_MEM 870 912
```

#### 4. GTE - Операция "больше или равно" (>=)
Синтаксис: `GTE <смещение1> <адрес1> <адрес2> <адрес_результата> <смещение2>`

- Код операции: 68
- Размер: 13 байт
- Параметры:
  - `смещение1` (8 бит, 0-255): смещение для первого операнда
  - `адрес1` (26 бит, 0-67108863): базовый адрес первого операнда
  - `адрес2` (26 бит, 0-67108863): адрес второго операнда
  - `адрес_результата` (26 бит, 0-67108863): базовый адрес для результата
  - `смещение2` (8 бит, 0-255): смещение для результата

Пример:
```
GTE 42 671 242 575 150
```

### Комментарии

Комментарии начинаются с символа `#` и продолжаются до конца строки:
```
# Это комментарий
LOAD_CONST 10 100  # Загрузка значения 10
```

### Пример программы

```assembly
# Программа копирования массива
LOAD_CONST 5 100    # Загрузить 5 в адрес 100
READ_MEM 0 100 200  # Прочитать из [100+0] в 200
WRITE_MEM 200 300   # Записать из 200 в 300
```

## Использование

### Ассемблер

```bash
python assembler.py <входной_файл.asm> <выходной_файл.bin> [--test]
```

Параметры:
- `входной_файл.asm` - файл с исходным кодом на языке ассемблера
- `выходной_файл.bin` - выходной бинарный файл
- `--test` - режим тестирования (вывод промежуточного представления)

### Интерпретатор

```bash
python interpreter.py <бинарный_файл.bin> <выходной_дамп.xml> <начальный_адрес> <конечный_адрес>
```

Параметры:
- `бинарный_файл.bin` - ассемблированная программа
- `выходной_дамп.xml` - файл для сохранения дампа памяти
- `начальный_адрес` - начало диапазона для дампа
- `конечный_адрес` - конец диапазона для дампа

## Структура проекта

```
.
├── README.md              # Документация
├── assembler.py           # Ассемблер
├── interpreter.py         # Интерпретатор
├── tests/                 # Тестовые программы
│   ├── test_spec.asm     # Тесты из спецификации
│   ├── test_copy.asm     # Тест копирования массива
│   ├── test_gte.asm      # Тест операции >=
│   └── test_vectors_*.asm # Тесты с векторами
└── results/               # Результаты выполнения
    └── *.xml             # Дампы памяти
```

## Спецификация УВМ

### Память
- Разделённая архитектура (память команд и данных)
- Адресация: 26 бит (до 67 миллионов ячеек)
- Размер ячейки: 32 бита

### Формат команд
Команды имеют переменную длину (6, 8, 9 или 13 байт) и кодируются в little-endian формате.

## Тестовые последовательности

### LOAD_CONST (A=111, B=37, C=80)
```
0xEF, 0x12, 0x40, 0x01, 0x00, 0x00
```

### READ_MEM (A=40, B=82, C=877, D=682)
```
0x28, 0xA9, 0xB6, 0x01, 0x00, 0x54, 0x05, 0x00, 0x00
```

### WRITE_MEM (A=101, B=870, C=912)
```
0x65, 0xB3, 0x01, 0x00, 0x20, 0x07, 0x00, 0x00
```

### GTE (A=68, B=42, C=671, D=242, E=575, F=150)
```
0x44, 0x95, 0x4F, 0x81, 0x80, 0xE4, 0x81, 0x80, 0xF8, 0x11, 0x80, 0xC0, 0x12
```

